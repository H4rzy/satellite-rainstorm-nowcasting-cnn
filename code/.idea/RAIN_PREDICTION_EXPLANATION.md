# ğŸŒ§ï¸ Dá»° ÄOÃN MÆ¯A Tá»ª áº¢NH Vá»† TINH - GIáº¢I THÃCH CHO THUYáº¾T TRÃŒNH

---

## ğŸ“Œ TÃ“M Táº®T NHANH (30 GIÃ‚Y)

> **Project nÃ y lÃ m gÃ¬?**  
> Sá»­ dá»¥ng áº£nh chá»¥p tá»« vá»‡ tinh Sentinel-2, Ä‘Æ°a qua máº¡ng neural ResNet34 Ä‘á»ƒ phÃ¢n loáº¡i thÃ nh 3 má»©c: **KhÃ´ng mÆ°a**, **MÆ°a vá»«a**, **MÆ°a náº·ng**.

```
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  áº¢nh vá»‡ tinh â”‚  â”€â”€â”€â”€â–º  â”‚   AI Model  â”‚  â”€â”€â”€â”€â–º  â”‚  Káº¿t quáº£    â”‚
    â”‚  (Sentinel-2)â”‚         â”‚  (ResNet34) â”‚         â”‚  mÆ°a/khÃ´ng  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1ï¸âƒ£ Vá»† TINH SENTINEL-2 CHá»¤P ÄÆ¯á»¢C GÃŒ?

### Vá»‡ tinh Sentinel-2

| ThÃ´ng sá»‘ | GiÃ¡ trá»‹ |
|----------|---------|
| **CÆ¡ quan** | ESA (European Space Agency) |
| **Äá»™ phÃ¢n giáº£i** | 10-60m/pixel |
| **Chu ká»³** | Quay láº¡i vá»‹ trÃ­ sau 5 ngÃ y |
| **Sá»‘ kÃªnh** | 13 kÃªnh phá»• (bands) |

### 3 KÃªnh Ä‘Æ°á»£c sá»­ dá»¥ng trong project

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     3 KÃŠNH SPECTRAL ÄÆ¯á»¢C CHá»ŒN                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ BAND 11 (SWIR - Short Wave Infrared)                               â”‚ â”‚
â”‚  â”‚ BÆ°á»›c sÃ³ng: 1610 nm                                                 â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚ âœ¦ Nháº¡y vá»›i Äá»˜ áº¨M trong khÃ­ quyá»ƒn                                  â”‚ â”‚
â”‚  â”‚ âœ¦ PhÃ¡t hiá»‡n hÆ¡i nÆ°á»›c, mÃ¢y chá»©a nÆ°á»›c                               â”‚ â”‚
â”‚  â”‚ âœ¦ MÆ°a â†’ giÃ¡ trá»‹ pixel THAY Äá»”I rÃµ rá»‡t                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ BAND 8 (NIR - Near Infrared)                                       â”‚ â”‚
â”‚  â”‚ BÆ°á»›c sÃ³ng: 842 nm                                                  â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚ âœ¦ PhÃ¡t hiá»‡n THá»°C Váº¬T vÃ  Ä‘á»™ áº©m bá» máº·t                              â”‚ â”‚
â”‚  â”‚ âœ¦ PhÃ¢n biá»‡t Ä‘áº¥t Æ°á»›t/khÃ´                                           â”‚ â”‚
â”‚  â”‚ âœ¦ Nháº­n diá»‡n mÃ¢y qua pháº£n xáº¡                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ BAND 4 (RED - Visible Red)                                         â”‚ â”‚
â”‚  â”‚ BÆ°á»›c sÃ³ng: 665 nm                                                  â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚ âœ¦ KÃªnh mÃ u Ä‘á» nhÃ¬n tháº¥y                                           â”‚ â”‚
â”‚  â”‚ âœ¦ Káº¿t há»£p vá»›i NIR Ä‘á»ƒ tÄƒng Ä‘á»™ chÃ­nh xÃ¡c                            â”‚ â”‚
â”‚  â”‚ âœ¦ PhÃ¢n biá»‡t loáº¡i mÃ¢y                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Táº¡i sao chá»n 3 kÃªnh nÃ y?

```
                    QUANG PHá»” ÄIá»†N Tá»ª
    â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
    
    Visible Light          Near IR            Short Wave IR
    (NhÃ¬n tháº¥y)           (Cáº­n há»“ng ngoáº¡i)    (Há»“ng ngoáº¡i sÃ³ng ngáº¯n)
    
    400nm â”€â”€â”€â”€â”€â”€â”€â”€ 700nm â”€â”€â”€â”€â”€â”€â”€â”€ 1000nm â”€â”€â”€â”€â”€â”€â”€â”€ 2000nm
           â”‚              â”‚                 â”‚
           â”‚              â”‚                 â”‚
         Band 4         Band 8           Band 11
         (Red)          (NIR)            (SWIR)
           â”‚              â”‚                 â”‚
           â–¼              â–¼                 â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ MÃ u sáº¯c mÃ¢y  â”‚ Äá»™ áº©m bá» máº·t â”‚ HÆ¡i nÆ°á»›c khÃ­ quyá»ƒn   â”‚
    â”‚ Loáº¡i mÃ¢y     â”‚ Pháº£n xáº¡ mÃ¢y  â”‚ MÃ¢y chá»©a mÆ°a         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    â†’ Káº¿t há»£p 3 kÃªnh = Äá»§ thÃ´ng tin Ä‘á»ƒ phÃ¢n biá»‡t mÆ°a/khÃ´ng mÆ°a
```

---

## 2ï¸âƒ£ CÃCH Dá»° ÄOÃN MÆ¯A HOáº T Äá»˜NG

### Quy trÃ¬nh tá»•ng quan

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         QUY TRÃŒNH Dá»° ÄOÃN MÆ¯A
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    BÆ¯á»šC 1                BÆ¯á»šC 2                BÆ¯á»šC 3              BÆ¯á»šC 4
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ğŸ“¡ Vá»‡    â”‚         â”‚ ğŸ”§ Tiá»n  â”‚          â”‚ ğŸ§  Máº¡ng  â”‚        â”‚ ğŸ“Š Káº¿t   â”‚
  â”‚ tinh     â”‚  â”€â”€â”€â”€â–º  â”‚   xá»­ lÃ½  â”‚  â”€â”€â”€â”€â–º   â”‚  Neural  â”‚ â”€â”€â”€â”€â–º  â”‚   quáº£    â”‚
  â”‚ chá»¥p áº£nh â”‚         â”‚   áº£nh    â”‚          â”‚ ResNet34 â”‚        â”‚  mÆ°a     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   
   File .TIFF            224Ã—224              TrÃ­ch xuáº¥t          3 classes:
   3 kÃªnh B11,B8,B4      Normalize            Ä‘áº·c trÆ°ng           0: KhÃ´ng mÆ°a
                         Augment              512 features        1: MÆ°a vá»«a
                                             â†’ 3 logits          2: MÆ°a náº·ng
```

---

### BÆ¯á»šC 1: Äá»c áº£nh vá»‡ tinh

```python
# File: dataset.py

# Äá»c file TIFF (Ä‘á»‹nh dáº¡ng áº£nh vá»‡ tinh)
img = tiff.imread("Sentinel2_HCMC_20231225.tif")

# áº¢nh cÃ³ 3 kÃªnh: B11, B8, B4
# KÃ­ch thÆ°á»›c: vÃ­ dá»¥ 512Ã—512Ã—3
```

**VÃ­ dá»¥ áº£nh:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         áº¢NH Vá»† TINH Gá»C                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   KhÃ´ng mÆ°a                MÆ°a vá»«a                  MÆ°a náº·ng           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚ â–‘â–‘â–‘â–“â–“â–‘â–‘â–‘â–‘â–‘ â”‚         â”‚ â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ â”‚         â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚      â”‚
â”‚   â”‚ â–‘â–‘â–‘â–‘â–‘â–‘â–“â–‘â–‘â–‘ â”‚         â”‚ â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ â”‚         â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚      â”‚
â”‚   â”‚ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â”‚         â”‚ â–“â–“â–“â–“â–‘â–‘â–“â–“â–“â–“ â”‚         â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚      â”‚
â”‚   â”‚ â–‘â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â”‚         â”‚ â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ â”‚         â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚   Ãt mÃ¢y, Ä‘áº¥t khÃ´         MÃ¢y dÃ y, cÃ³ mÆ°a         MÃ¢y ráº¥t dÃ y         â”‚
â”‚   Pixel sÃ¡ng              Pixel xÃ¡m vá»«a           Pixel tá»‘i Ä‘áº­m       â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### BÆ¯á»šC 2: Tiá»n xá»­ lÃ½ áº£nh

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         TIá»€N Xá»¬ LÃ áº¢NH                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   áº¢nh gá»‘c (512Ã—512)          Xá»­ lÃ½ NaN            Normalize [0,1]
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ 1234  NaN  456  â”‚  â”€â”€â–º  â”‚ 1234   0   456â”‚ â”€â”€â–º â”‚ 0.48  0   0.18â”‚
   â”‚ 789   123  NaN  â”‚       â”‚ 789   123   0 â”‚     â”‚ 0.31 0.05  0  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                            Resize 224Ã—224
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â”‚
                           â”‚ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â”‚  â† KÃ­ch thÆ°á»›c chuáº©n
                           â”‚ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â”‚     cho ResNet
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                            Data Augmentation
                                 (Train)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Flip     â”‚  â”‚ Rotate   â”‚  â”‚ Crop     â”‚  â”‚ Color    â”‚
   â”‚ ngang/dá»câ”‚  â”‚ xoay 90Â° â”‚  â”‚ cáº¯t ngáº«u â”‚  â”‚ Ä‘á»•i mÃ u  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚              â”‚            â”‚             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                      1 áº£nh â†’ nhiá»u biáº¿n thá»ƒ
                      â†’ Model há»c tá»•ng quÃ¡t hÆ¡n
```

---

### BÆ¯á»šC 3: ÄÆ°a qua máº¡ng Neural ResNet34

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ResNet34 - TRÃCH XUáº¤T Äáº¶C TRÆ¯NG                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Input: áº¢nh 224Ã—224Ã—3
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CONV1: Lá»c áº£nh báº±ng bá»™ lá»c 7Ã—7                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  áº¢nh                    Bá»™ lá»c 7Ã—7              Feature Map         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚ â”‚
â”‚  â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚     *      â”‚â– â– â– â– â– â– â– â”‚      =        â”‚â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚         â”‚ â”‚
â”‚  â”‚  â”‚â–‘â–‘â–“â–“â–“â–‘â–‘â–‘â–‘â”‚            â”‚â– â– â– â– â– â– â– â”‚               â”‚â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â”‚         â”‚ â”‚
â”‚  â”‚  â”‚â–‘â–‘â–“â–“â–“â–‘â–‘â–‘â–‘â”‚            â”‚â– â– â– â– â– â– â– â”‚               â”‚â–‘â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â”‚         â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ â”‚
â”‚  â”‚                                                                     â”‚ â”‚
â”‚  â”‚  â†’ PhÃ¡t hiá»‡n Cáº NH, ÄÆ¯á»œNG VIá»€N mÃ¢y                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LAYER 1-2: Há»c Ä‘áº·c trÆ°ng CÆ  Báº¢N                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  â€¢ Cáº¡nh ngang, cáº¡nh dá»c                                             â”‚ â”‚
â”‚  â”‚  â€¢ GÃ³c, Ä‘Æ°á»ng cong                                                  â”‚ â”‚
â”‚  â”‚  â€¢ Texture (káº¿t cáº¥u bá» máº·t)                                         â”‚ â”‚
â”‚  â”‚  â€¢ Gradient mÃ u                                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LAYER 3-4: Há»c Ä‘áº·c trÆ°ng PHá»¨C Táº P                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  â€¢ HÃ¬nh dáº¡ng mÃ¢y                                                    â”‚ â”‚
â”‚  â”‚  â€¢ Máº­t Ä‘á»™ mÃ¢y                                                       â”‚ â”‚
â”‚  â”‚  â€¢ Äá»™ dÃ y mÃ¢y                                                       â”‚ â”‚
â”‚  â”‚  â€¢ Pattern Ä‘áº·c trÆ°ng cá»§a mÃ¢y mÆ°a                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FULLY CONNECTED: Quyáº¿t Ä‘á»‹nh phÃ¢n loáº¡i                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                     â”‚ â”‚
â”‚  â”‚  512 features â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º 3 outputs                 â”‚ â”‚
â”‚  â”‚  (Ä‘áº·c trÆ°ng                                (logits)                 â”‚ â”‚
â”‚  â”‚   trÃ­ch xuáº¥t)                                                       â”‚ â”‚
â”‚  â”‚                                                                     â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚ Feature 1: Máº­t Ä‘á»™ mÃ¢y cao    â”‚â”€â”€â”                            â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ Feature 2: Pixel tá»‘i nhiá»u   â”‚â”€â”€â”¤                            â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ Feature 3: SWIR signal máº¡nh  â”‚â”€â”€â”¼â”€â”€â–º logit_not_rain   = -2.5 â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ Feature 4: Edge pattern      â”‚â”€â”€â”¤    logit_medium     =  1.2 â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ ...                          â”‚â”€â”€â”¤    logit_heavy      =  0.3 â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ Feature 512: ...             â”‚â”€â”€â”˜                            â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### BÆ¯á»šC 4: TÃ­nh xÃ¡c suáº¥t vÃ  Ä‘Æ°a ra káº¿t quáº£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SOFTMAX VÃ€ QUYáº¾T Äá»ŠNH CUá»I CÃ™NG                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Logits (raw scores)              Softmax                    Predict
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ not_rain: -2.5  â”‚         â”‚ not_rain:  3%   â”‚        â”‚                 â”‚
    â”‚ medium:    1.2  â”‚  â”€â”€â”€â”€â–º  â”‚ medium:   65%   â”‚ â”€â”€â”€â”€â–º  â”‚  "medium_rain"  â”‚
    â”‚ heavy:     0.3  â”‚         â”‚ heavy:    32%   â”‚        â”‚   (65% cháº¯c)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
                                        â”‚
                                        â–¼
                                   argmax(probs)
                                        â”‚
                                        â–¼
                                  index = 1 (medium)
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  CÃ”NG THá»¨C SOFTMAX:                                                   â•‘
    â•‘                                                                       â•‘
    â•‘            e^(logit_i)                                                â•‘
    â•‘  P(i) = â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                             â•‘
    â•‘         Î£ e^(logit_j)                                                 â•‘
    â•‘                                                                       â•‘
    â•‘  VÃ­ dá»¥: P(medium) = e^1.2 / (e^-2.5 + e^1.2 + e^0.3)                 â•‘
    â•‘                   = 3.32 / (0.08 + 3.32 + 1.35)                      â•‘
    â•‘                   = 3.32 / 4.75                                       â•‘
    â•‘                   = 0.70 = 70%                                        â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 3ï¸âƒ£ Táº I SAO MODEL Dá»° ÄOÃN ÄÆ¯á»¢C MÆ¯A?

### Äiá»u model Ä‘Ã£ "há»c" Ä‘Æ°á»£c

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MODEL Há»ŒC ÄÆ¯á»¢C GÃŒ Tá»ª Dá»® LIá»†U?                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                         KHÃ”NG MÆ¯A                                     â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
    â”‚  â”‚  âœ“ Pixel sÃ¡ng (pháº£n xáº¡ cao)                                   â”‚    â”‚
    â”‚  â”‚  âœ“ Ãt mÃ¢y hoáº·c khÃ´ng cÃ³ mÃ¢y                                   â”‚    â”‚
    â”‚  â”‚  âœ“ SWIR (Band 11) signal tháº¥p (khÃ´ng cÃ³ hÆ¡i nÆ°á»›c)            â”‚    â”‚
    â”‚  â”‚  âœ“ Texture Ä‘á»“ng Ä‘á»u (khÃ´ng cÃ³ pattern mÃ¢y)                    â”‚    â”‚
    â”‚  â”‚  âœ“ Äá»™ tÆ°Æ¡ng pháº£n tháº¥p                                         â”‚    â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                         MÆ¯A Vá»ªA                                       â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
    â”‚  â”‚  âœ“ Pixel mÃ u xÃ¡m (pháº£n xáº¡ trung bÃ¬nh)                        â”‚    â”‚
    â”‚  â”‚  âœ“ MÃ¢y phá»§ má»™t pháº§n                                           â”‚    â”‚
    â”‚  â”‚  âœ“ SWIR signal trung bÃ¬nh                                     â”‚    â”‚
    â”‚  â”‚  âœ“ CÃ³ pattern mÃ¢y nhÆ°ng khÃ´ng dÃ y Ä‘áº·c                         â”‚    â”‚
    â”‚  â”‚  âœ“ CÃ³ vÃ¹ng sÃ¡ng xen káº½ vÃ¹ng tá»‘i                              â”‚    â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                         MÆ¯A Náº¶NG                                      â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
    â”‚  â”‚  âœ“ Pixel tá»‘i (háº¥p thá»¥ cao, pháº£n xáº¡ tháº¥p)                     â”‚    â”‚
    â”‚  â”‚  âœ“ MÃ¢y dÃ y phá»§ toÃ n bá»™                                        â”‚    â”‚
    â”‚  â”‚  âœ“ SWIR signal ráº¥t cao (nhiá»u hÆ¡i nÆ°á»›c)                      â”‚    â”‚
    â”‚  â”‚  âœ“ Texture Ä‘áº·c trÆ°ng cá»§a mÃ¢y tÃ­ch mÆ°a (cumulonimbus)         â”‚    â”‚
    â”‚  â”‚  âœ“ Äá»“ng nháº¥t tá»‘i trÃªn diá»‡n rá»™ng                               â”‚    â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Váº­t lÃ½ Ä‘áº±ng sau

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Táº I SAO KÃŠNH SWIR QUAN TRá»ŒNG?                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                        â”‚
    â”‚  â˜€ï¸ Ãnh sÃ¡ng máº·t trá»i                                                  â”‚
    â”‚        â”‚                                                               â”‚
    â”‚        â–¼                                                               â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
    â”‚  â”‚         â˜ï¸ MÃ‚Y CHá»¨A HÆ I NÆ¯á»šC              â”‚                       â”‚
    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                       â”‚
    â”‚  â”‚  â”‚   NÆ°á»›c á»Ÿ dáº¡ng hÆ¡i + giá»t nhá»         â”‚  â”‚                       â”‚
    â”‚  â”‚  â”‚                                      â”‚  â”‚                       â”‚
    â”‚  â”‚  â”‚   â–º Háº¥p thá»¥ tia SWIR (1610nm)       â”‚  â”‚                       â”‚
    â”‚  â”‚  â”‚   â–º CÃ ng nhiá»u nÆ°á»›c â†’ háº¥p thá»¥ nhiá»u â”‚  â”‚                       â”‚
    â”‚  â”‚  â”‚   â–º Vá»‡ tinh nháº­n Ä‘Æ°á»£c tÃ­n hiá»‡u THáº¤P â”‚  â”‚                       â”‚
    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                       â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
    â”‚        â”‚                                                               â”‚
    â”‚        â–¼                                                               â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
    â”‚  â”‚  ğŸ“¡ Vá»† TINH SENTINEL-2                     â”‚                       â”‚
    â”‚  â”‚                                             â”‚                       â”‚
    â”‚  â”‚  Nháº­n tÃ­n hiá»‡u SWIR:                        â”‚                       â”‚
    â”‚  â”‚  â€¢ MÃ¢y mÆ°a â†’ tÃ­n hiá»‡u Yáº¾U â†’ pixel Tá»I      â”‚                       â”‚
    â”‚  â”‚  â€¢ Trá»i trong â†’ tÃ­n hiá»‡u Máº NH â†’ pixel SÃNG â”‚                       â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
    â”‚                                                                        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4ï¸âƒ£ CÃC Ká»¸ THUáº¬T Äáº¶C BIá»†T

### 4.1 Transfer Learning

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        TRANSFER LEARNING                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  CÃCH TRUYá»€N THá»NG (tá»« Ä‘áº§u)                                            â”‚
    â”‚                                                                         â”‚
    â”‚  Model trá»‘ng â”€â”€â”€â”€â–º Training 1 triá»‡u áº£nh â”€â”€â”€â”€â–º Model trained            â”‚
    â”‚  (random)          (ImageNet dataset)         (biáº¿t phÃ¢n loáº¡i)         â”‚
    â”‚                                                                         â”‚
    â”‚  â±ï¸ Thá»i gian: Nhiá»u ngÃ y/tuáº§n                                         â”‚
    â”‚  ğŸ’» TÃ i nguyÃªn: GPU máº¡nh                                                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
                                    VS
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  TRANSFER LEARNING (project nÃ y)                                        â”‚
    â”‚                                                                         â”‚
    â”‚  ResNet34 pretrained â”€â”€â”€â”€â–º Fine-tune áº£nh vá»‡ tinh â”€â”€â”€â”€â–º Model ready     â”‚
    â”‚  (Ä‘Ã£ biáº¿t nháº­n diá»‡n        (chá»‰ vÃ i nghÃ¬n áº£nh)        (biáº¿t phÃ¢n loáº¡i  â”‚
    â”‚   cáº¡nh, texture...)                                    mÃ¢y mÆ°a)        â”‚
    â”‚                                                                         â”‚
    â”‚  â±ï¸ Thá»i gian: VÃ i giá»                                                 â”‚
    â”‚  ğŸ’» TÃ i nguyÃªn: GPU bÃ¬nh thÆ°á»ng                                         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  Ã TÆ¯á»NG:                                                             â•‘
    â•‘  â€¢ Layer Ä‘áº§u Ä‘Ã£ há»c "nhÃ¬n" tá»« ImageNet (1 triá»‡u áº£nh)                  â•‘
    â•‘  â€¢ Chá»‰ cáº§n "dáº¡y" layer cuá»‘i phÃ¢n biá»‡t mÃ¢y mÆ°a                         â•‘
    â•‘  â€¢ Tiáº¿t kiá»‡m thá»i gian vÃ  tÃ i nguyÃªn                                  â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 4.2 Focal Loss

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Váº¤N Äá»€ Máº¤T CÃ‚N Báº°NG Dá»® LIá»†U                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Dataset phÃ¢n bá»‘:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ KhÃ´ng mÆ°a    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  (60%)           â”‚
    â”‚ MÆ°a vá»«a      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                          (30%)           â”‚
    â”‚ MÆ°a náº·ng     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                    (10%) â† Ãt!     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Váº¥n Ä‘á» vá»›i Cross-Entropy thÃ´ng thÆ°á»ng:
    â€¢ Model cÃ³ xu hÆ°á»›ng Ä‘oÃ¡n "KhÃ´ng mÆ°a" (class nhiá»u nháº¥t)
    â€¢ Äáº¡t accuracy cao nhÆ°ng miss "MÆ°a náº·ng" (quan trá»ng nháº¥t!)
    
    FOCAL LOSS giáº£i quyáº¿t nhÆ° tháº¿ nÃ o?
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                        â”‚
    â”‚  Máº«u Dá»„ (model Ä‘Ã£ Ä‘oÃ¡n Ä‘Ãºng 95%):                                     â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                      â”‚
    â”‚  Cross-Entropy: loss = 0.05                                            â”‚
    â”‚  Focal Loss:    loss = 0.05 Ã— (1-0.95)^2.5 = 0.05 Ã— 0.0009 â‰ˆ 0        â”‚
    â”‚                        â†“                                               â”‚
    â”‚                 Gáº§n nhÆ° bá» qua, khÃ´ng cáº§n há»c thÃªm                     â”‚
    â”‚                                                                        â”‚
    â”‚  Máº«u KHÃ“ (model chá»‰ Ä‘oÃ¡n Ä‘Ãºng 30%):                                   â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â”‚
    â”‚  Cross-Entropy: loss = 1.2                                             â”‚
    â”‚  Focal Loss:    loss = 1.2 Ã— (1-0.30)^2.5 = 1.2 Ã— 0.4 = 0.48          â”‚
    â”‚                        â†“                                               â”‚
    â”‚                 Giá»¯ loss cao, táº­p trung há»c máº«u nÃ y                   â”‚
    â”‚                                                                        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 Learning Rate khÃ¡c nhau cho tá»«ng layer

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DIFFERENTIAL LEARNING RATES                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                         â”‚
    â”‚  Layer Ä‘áº§u (conv1, layer1, layer2)       LR = 0.00005 (Ráº¤T NHá»)        â”‚
    â”‚  â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“         ÄÃ£ há»c tá»‘t tá»« ImageNet         â”‚
    â”‚  Giá»¯ nguyÃªn pháº§n lá»›n, chá»‰ tinh chá»‰nh nháº¹                               â”‚
    â”‚                                                                         â”‚
    â”‚  Layer giá»¯a (layer3, layer4)             LR = 0.0002 (Vá»ªA)             â”‚
    â”‚  â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“                   Äiá»u chá»‰nh cho domain         â”‚
    â”‚  ThÃ­ch nghi vá»›i Ä‘áº·c Ä‘iá»ƒm áº£nh vá»‡ tinh                                   â”‚
    â”‚                                                                         â”‚
    â”‚  Layer cuá»‘i (fc)                         LR = 0.0003 (Lá»šN)             â”‚
    â”‚  â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“      Layer má»›i, cáº§n há»c tá»« Ä‘áº§u      â”‚
    â”‚  Há»c nhanh Ä‘á»ƒ phÃ¢n loáº¡i mÆ°a                                            â”‚
    â”‚                                                                         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5ï¸âƒ£ TÃ“M Táº®T CHO SLIDE THUYáº¾T TRÃŒNH

### Slide 1: Giá»›i thiá»‡u
> **Má»¥c tiÃªu**: Dá»± Ä‘oÃ¡n mÆ°a tá»« áº£nh vá»‡ tinh Sentinel-2  
> **PhÆ°Æ¡ng phÃ¡p**: Deep Learning vá»›i ResNet34  
> **Output**: 3 má»©c Ä‘á»™ (KhÃ´ng mÆ°a, MÆ°a vá»«a, MÆ°a náº·ng)

### Slide 2: Dá»¯ liá»‡u Ä‘áº§u vÃ o
| ThÃ´ng sá»‘ | GiÃ¡ trá»‹ |
|----------|---------|
| **Nguá»“n** | Vá»‡ tinh Sentinel-2 (ESA) |
| **Format** | TIFF |
| **Channels** | B11 (SWIR), B8 (NIR), B4 (Red) |
| **KÃ­ch thÆ°á»›c** | Resize vá» 224Ã—224 |

### Slide 3: Kiáº¿n trÃºc model
| ThÃ nh pháº§n | Chi tiáº¿t |
|------------|----------|
| **Base** | ResNet34 pretrained ImageNet |
| **Layers** | 34 layers vá»›i skip connections |
| **FC** | Dropout(0.6) + Linear(512â†’3) |
| **Output** | 3 classes: not_rain, medium_rain, heavy_rain |

### Slide 4: Ká»¹ thuáº­t training
| Ká»¹ thuáº­t | Má»¥c Ä‘Ã­ch |
|----------|----------|
| **Transfer Learning** | Táº­n dá»¥ng weights Ä‘Ã£ há»c tá»« ImageNet |
| **Focal Loss (Î³=2.5)** | Xá»­ lÃ½ máº¥t cÃ¢n báº±ng dá»¯ liá»‡u |
| **Adam Optimizer** | Há»™i tá»¥ nhanh, á»•n Ä‘á»‹nh |
| **Differential LR** | LR khÃ¡c nhau cho tá»«ng layer |
| **Data Augmentation** | TÄƒng diversity, giáº£m overfitting |

### Slide 5: Káº¿t quáº£
| Metric | GiÃ¡ trá»‹ |
|--------|---------|
| **Epochs** | 40 |
| **Best Model** | Saved khi val_loss tháº¥p nháº¥t |
| **Output** | Class + Probability |

---

## 6ï¸âƒ£ CÃ‚U Há»I THÆ¯á»œNG Gáº¶P

### Q1: Táº¡i sao khÃ´ng dÃ¹ng RGB thÃ´ng thÆ°á»ng?
> **A**: RGB chá»‰ tháº¥y mÃ u sáº¯c bá» máº·t mÃ¢y. SWIR (B11) "nhÃ¬n xuyÃªn" Ä‘Æ°á»£c hÆ¡i nÆ°á»›c, cho biáº¿t mÃ¢y cÃ³ chá»©a mÆ°a khÃ´ng.

### Q2: Táº¡i sao chá»n ResNet34 thay vÃ¬ ResNet50 hay ResNet101?
> **A**: ResNet34 cÃ¢n báº±ng giá»¯a Ä‘á»™ chÃ­nh xÃ¡c vÃ  tá»‘c Ä‘á»™. 34 layers Ä‘á»§ máº¡nh cho bÃ i toÃ¡n 3 classes, khÃ´ng cáº§n model quÃ¡ náº·ng.

### Q3: Transfer Learning cÃ³ thá»±c sá»± hiá»‡u quáº£?
> **A**: Ráº¥t hiá»‡u quáº£! ImageNet dáº¡y model "nhÃ¬n" cáº¡nh, texture, hÃ¬nh dáº¡ng. Nhá»¯ng ká»¹ nÄƒng nÃ y Ã¡p dá»¥ng Ä‘Æ°á»£c cho má»i loáº¡i áº£nh.

### Q4: Focal Loss khÃ¡c gÃ¬ Cross-Entropy?
> **A**: Cross-Entropy Ä‘á»‘i xá»­ cÃ´ng báº±ng vá»›i má»i máº«u. Focal Loss "bá» qua" máº«u dá»…, táº­p trung vÃ o máº«u khÃ³ (nhÆ° heavy_rain Ã­t máº«u).

### Q5: Model cÃ³ thá»ƒ dá»± Ä‘oÃ¡n realtime khÃ´ng?
> **A**: CÃ³! Inference chá»‰ máº¥t ~50ms/áº£nh trÃªn GPU. CÃ³ thá»ƒ tÃ­ch há»£p vÃ o há»‡ thá»‘ng cáº£nh bÃ¡o thá»i tiáº¿t.

---

**ğŸ“ TÃ i liá»‡u nÃ y Ä‘Æ°á»£c táº¡o Ä‘á»ƒ phá»¥c vá»¥ thuyáº¿t trÃ¬nh vá» há»‡ thá»‘ng dá»± Ä‘oÃ¡n mÆ°a tá»« áº£nh vá»‡ tinh.**
